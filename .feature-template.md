# Admin CRUD Feature Template

## Task: Implement Admin CRUD for User Management under /admin and /api/admin

### Constraints
- Basic Auth already protects routes
- Use Zod for all payloads
- On error return 400 with issues
- Log to AdminAudit

### Acceptance Criteria
- I can create/edit/delete from the UI
- JSON APIs validate
- ./scripts/verify.sh green

### PLAN
**Files to touch:**
- `src/app/admin/users/page.tsx` - Admin UI
- `src/app/api/admin/users/route.ts` - API endpoints
- `src/lib/validations/user.ts` - Zod schemas
- `src/lib/admin-audit.ts` - Audit logging
- `src/components/admin/UserForm.tsx` - Form component
- `src/components/admin/UserTable.tsx` - Table component

**Files never touch:**
- `next-env.d.ts`
- `.next/**`
- `pnpm-lock.yaml`

**Risk list:**
- Authentication bypass
- Data validation errors
- UI/API inconsistency

### TESTS FIRST
```typescript
// tests/admin-crud.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Admin CRUD', () => {
  test('Admin users page requires auth', async ({ page }) => {
    const response = await page.goto('/admin/users');
    expect(response?.status()).toBe(401);
  });

  test('API endpoints require auth', async ({ page }) => {
    const response = await page.request.get('/api/admin/users');
    expect(response.status()).toBe(401);
  });
});
```

### ACCEPTANCE CRITERIA
- Lint/type/build/tests must pass
- Public pages in English only
- No breaking changes to existing routes
- Diff â‰¤ 300 LOC

### IMPLEMENTATION
1. Create Zod schemas
2. Create API routes with validation
3. Create admin UI components
4. Add audit logging
5. Write tests

### RUN VERIFY
```bash
./scripts/verify.sh
```

### NEXT STEPS
- Test with real data
- Add pagination
- Add search/filter

